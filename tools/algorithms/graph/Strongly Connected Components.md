有向图的强连通分量（Strongly Connected Components）

# Tarjan 算法

给定一张图，将图中的所有强连通分量圈起来，图中的每一个顶点都会落在某个圈内，若两个不同圈内的顶点之间有边相连，则在两个圈之间添加一条有向边。

如此一来，所有的圈和圈与圈之间的有向边构成一个有向无环图。

> 反证法：假设某几个圈可以形成环，它们可以组成一个更大的强连通分量，矛盾。

SCC 的任务是找出所有的圈。

考虑深度优先遍历的过程。我们首先将所有的结点按照被访问的次序进行编号，注意到：
- 每一个圈内都有一个结点编号最小，这个结点正是圈内第一个被 dfs 访问到的结点，记为 $u_s$。
- 从圈内任意结点出发均能访问到 $u_s$ ，且访问不到 $u_s$ 的祖先结点。
- 若将圈内结点的最小编号作为圈的编号，则圈的编号沿 DAG 上未访问过的圈路径递增。

任选一个顶点作为起点对图进行深度优先遍历，维护：
- $dfn_u$： 结点 $u$ 被访问的次序。
- $low_u$: 从结点 $u$ 出发，经过未被访问的边能访问到的在搜索树在上的最小的编号。